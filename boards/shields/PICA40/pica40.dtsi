#include <dt-bindings/zmk/matrix_transform.h>

/ {
    kscan0: kscan0 {
        compatible = "zmk,kscan-gpio-matrix";
        diode-direction = "col2row";
        wakeup-source;

        row-gpios
            = <&xiao_d 10 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&xiao_d 9 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&xiao_d 8 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&xiao_d 7 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>;
    };
};

/ {
    keymap_transform0: keymap_transform0 {
        compatible = "zmk,matrix-transform";
        columns = <10>;
        rows = <4>;
        map = <
                    RC(0,0) RC(0,1) RC(0,2) RC(0,3) RC(0,4)  RC(0,5) RC(0,6) RC(0,7) RC(0,8) RC(0,9) 
            RC(3,0) RC(1,0) RC(1,1) RC(1,2) RC(1,3) RC(1,4)  RC(1,5) RC(1,6) RC(1,7) RC(1,8) RC(1,9) RC(3,9)
            RC(3,1) RC(2,0) RC(2,1) RC(2,2) RC(2,3) RC(2,4)  RC(2,5) RC(2,6) RC(2,7) RC(2,8) RC(2,9) RC(3,8) 
                                    RC(3,2) RC(3,3) RC(3,4)  RC(3,5) RC(3,6) RC(3,7)
        >;
    };
};

/ {
    default_layout: default_layout {
        compatible = "zmk,physical-layout";
        display-name = "Default Layout";
        transform = <&keymap_transform0>;
        kscan = <&kscan0>;

        keys {
            compatible = "zmk,keys";

            key-0 { zmk,position-x = <1>; zmk,position-y = <0.775>; };
            key-1 { zmk,position-x = <2>; zmk,position-y = <0.125>; };
            key-2 { zmk,position-x = <3>; zmk,position-y = <0>; };
            key-3 { zmk,position-x = <4>; zmk,position-y = <0.125>; };
            key-4 { zmk,position-x = <5>; zmk,position-y = <0.25>; };
            key-5 { zmk,position-x = <9>; zmk,position-y = <0.25>; };
            key-6 { zmk,position-x = <10>; zmk,position-y = <0.125>; };
            key-7 { zmk,position-x = <11>; zmk,position-y = <0>; };
            key-8 { zmk,position-x = <12>; zmk,position-y = <0.125>; };
            key-9 { zmk,position-x = <13>; zmk,position-y = <0.775>; };
            key-10 { zmk,position-x = <0>; zmk,position-y = <1.525>; };
            key-11 { zmk,position-x = <1>; zmk,position-y = <1.775>; };
            key-12 { zmk,position-x = <2>; zmk,position-y = <1.125>; };
            key-13 { zmk,position-x = <3>; zmk,position-y = <1>; };
            key-14 { zmk,position-x = <4>; zmk,position-y = <1.125>; };
            key-15 { zmk,position-x = <5>; zmk,position-y = <1.25>; };
            key-16 { zmk,position-x = <9>; zmk,position-y = <1.25>; };
            key-17 { zmk,position-x = <10>; zmk,position-y = <1.125>; };
            key-18 { zmk,position-x = <11>; zmk,position-y = <1>; };
            key-19 { zmk,position-x = <12>; zmk,position-y = <1.125>; };
            key-20 { zmk,position-x = <13>; zmk,position-y = <1.775>; };
            key-21 { zmk,position-x = <14>; zmk,position-y = <1.525>; };
            key-22 { zmk,position-x = <0>; zmk,position-y = <2.525>; };
            key-23 { zmk,position-x = <1>; zmk,position-y = <2.775>; };
            key-24 { zmk,position-x = <2>; zmk,position-y = <2.125>; };
            key-25 { zmk,position-x = <3>; zmk,position-y = <2>; };
            key-26 { zmk,position-x = <4>; zmk,position-y = <2.125>; };
            key-27 { zmk,position-x = <5>; zmk,position-y = <2.25>; };
            key-28 { zmk,position-x = <9>; zmk,position-y = <2.25>; };
            key-29 { zmk,position-x = <10>; zmk,position-y = <2.125>; };
            key-30 { zmk,position-x = <11>; zmk,position-y = <2>; };
            key-31 { zmk,position-x = <12>; zmk,position-y = <2.125>; };
            key-32 { zmk,position-x = <13>; zmk,position-y = <2.775>; };
            key-33 { zmk,position-x = <14>; zmk,position-y = <2.525>; };
            key-34 { zmk,position-x = <3.48>; zmk,position-y = <3.125>; };
            key-35 { zmk,position-x = <3.48>; zmk,position-y = <3.125>; };
            key-36 { zmk,position-x = <3.48>; zmk,position-y = <2.9>; };
            key-37 { zmk,position-x = <10.52>; zmk,position-y = <2.9>; };
            key-38 { zmk,position-x = <10.52>; zmk,position-y = <3.125>; };
            key-39 { zmk,position-x = <10.52>; zmk,position-y = <3.125>; };
        };
    };
};

/ {
    chosen {
        zmk,physical-layout = &default_layout;
    };
};
